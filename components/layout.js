import React, { useEffect } from "react";
import Head from "next/head";
import styled from "styled-components";
import { useAppDispatch } from "../redux/app/hooks.ts";
import { setFavorites, setLanguage } from "../redux/userPreferencesSlice";
import Header from "./Header";
import Footer from "./Footer";

function Layout({ children }) {
  const dispatch = useAppDispatch();

  useEffect(() => {
    if (localStorage.favorites) {
      const storedFavorites = localStorage.getItem("favorites");
      const selectedLanguage = localStorage.getItem("language");
      
      dispatch(setFavorites(JSON.parse(storedFavorites)));
      dispatch(setLanguage(selectedLanguage));
    }
  }, []);

  return (
    <>
      <Main>
        <Head>
          <title>ManipulaMusic</title>
          <meta name="description" content="Generated by create next app" />
          <link rel="icon" href="/favicon.ico" />
        </Head>

        <Header />
        <div>{children}</div>
        <Footer />
      </Main>
    </>
  );
}

export default Layout;

const Main = styled.main`
  overflow-x: hidden;
  width: 100%;
`;
